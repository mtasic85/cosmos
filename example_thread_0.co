thread = import('cosmos/thread')
Thread = thread.Thread
tjoin = thread.join

a = range(1000000)
N = 4

threads = map(range(N), (i) -> {
    s = i * len(a) / N
    e = (i + 1) * len(a) / N
    b = a[s, e]

    Thread((self) -> {
        reduce(b, 0, (accu, i) -> {accu + i})
    })
})

threads_map = tjoin(threads)

each(threads_map, (t, r) -> {
    print('thread:', t, 'result:', r)
})
